<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    namespace：必须与对应的接口全类名一致  UserMapper.java
    id ：必须与对应接口的某个对应的方法名一致即必须要和UserMapper.java接口中的方法同名。
 -->
<mapper namespace="com.zafu.nichang.mapper.ProductMapper">

    <insert id="insertProduct" parameterType="java.util.List" useGeneratedKeys="false">
        insert into product_everyday_detail(product_name,min_price,avg_price,max_price,size_type,unit,date_time,product_type,insert_time,update_time)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (
                #{item.productName},
                #{item.minPrice},
                #{item.avgPrice},
                #{item.maxPrice},
                #{item.sizeType},
                #{item.unit},
                #{item.dateTime},
                #{item.productType},
                NOW(),
                NOW()
            )
        </foreach>
    </insert>

    <select id="selectProduct" resultMap="BaseResultMap">
        select *
        from product_everyday_detail
        <where>
            <if test="productName != null and startDT != null and endDT != null">
                product_name = #{productName, jdbcType=VARCHAR} and
                date_time <![CDATA[>=]]> #{startDT, jdbcType=VARCHAR} and date_time <![CDATA[<=]]> #{endDT, jdbcType=VARCHAR}
            </if>
            <if test="productName == null and startDT != null and endDT != null">
                date_time <![CDATA[>=]]> #{startDT, jdbcType=VARCHAR} and date_time <![CDATA[<=]]> #{endDT, jdbcType=VARCHAR}
            </if>
            <if test="productName != null and startDT == null and endDT != null">
                product_name = #{productName, jdbcType=VARCHAR} and
                 date_time <![CDATA[<=]]> #{endDT, jdbcType=VARCHAR}
            </if>
            <if test="productName != null and startDT != null and endDT == null">
                product_name = #{productName, jdbcType=VARCHAR} and
                date_time <![CDATA[>=]]> #{startDT, jdbcType=VARCHAR}
            </if>
            <if test="productName != null and startDT == null and endDT == null">
                product_name = #{productName, jdbcType=VARCHAR}
            </if>
        </where>

    </select>

</mapper>